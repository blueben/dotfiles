#compdef consult

_consult() {
  local curcontext="$curcontext" subcommand line
  typeset -A opt_args

  _arguments \
    '1: :->command'\
    '*: :->param'

  case $subcommand in
    command)
      _arguments '1:Subcommands:(help list http ssh query health)'
      ;;
    *)
      case $param in
        list)
          compadd "$@" service dc node
          ;;
        http)
          compadd "$@" --service
          ;;
        ssh)
          compadd "$@" --service
          ;;
        query)
          compadd "$@" --service
          ;;
        health)
          compadd "$@" node service check state
      esac
  esac
}

_consult "$@"


#  list service
#    List Consult services
#
#  list dc
#    List Consul DataCenters
#
#  list node
#    List Consul nodes
#
#  http --service=SERVICE [<flags>]
#    HTTP Query a Consul service endpoint
#
#  ssh --service=SERVICE [<flags>]
#    ssh into server using Consul query
#
#  query --service=SERVICE [<flags>]
#    Query Consul catalog
#
#  health node <node>
#    Show node health status
#
#  health service <service>
#    Show service health status
#
#  health check <service>
#    Show checks for service
#
#  health state [<state>]
#    Show checks in state
