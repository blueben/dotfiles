autoload -U +X bashcompinit && bashcompinit

_consult ()
{
  # Pointer to current completion word.
  local cur

  COMPREPLY=()   # Array variable storing the possible completions.
  cur=${COMP_WORDS[COMP_CWORD]}

  case "$cur" in
    *)
      COMPREPLY=( $(compgen -W 'list http ssh query health' -- $cur) )
      ;;
    list)
      COMPREPLY=( $(compgen -W 'service dc node' -- $cur) )
      ;;
    http)
      COMPREPLY=( $(compgen -W '--service=' -- $cur) )
      ;;
    ssh)
      COMPREPLY=( $(compgen -W '--service=' -- $cur) )
      ;;
    query)
      COMPREPLY=( $(compgen -W '--service=' -- $cur) )
      ;;
    health)
      COMPREPLY=( $(compgen -W 'node service check state' -- $cur) )
      ;;

esac
